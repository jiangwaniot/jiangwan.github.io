---
layout: post
title: "线性规划-单纯形算法"
excerpt: "介绍如何用单纯形法求解线性规划算法"
modified: 2017-05-12
categories: articles
tags: [LP, Algorithm]
comments: true
share: true
---

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script>


## 线性规划问题
最小化 
	\\[-2x_1 + 3x_2\\]
满足约束
	\\[x_1 + x_2 = 7\\]
	\\[x_1 - 2x_2 ≤ 4\\]
	\\[x_1 >= 0\\]

## 标准型定义

最大化 
	\\[c^Tx \\]
满足约束
\\[ Ax ≤ b \\]
\\[ x ≥ 0\\]

满足一下4个原因之一，则不是标准型:

* 目标函数可能是最小化
* 可能有变量<0
* 可能有等式约束
* 可能有≤约束

如何变为标准形式？

* 原来是min, 直接*-1求max
* 若原来约束为=，转为 >= 和<=
* 约束原来为 >= 同样的*-1，就改变了<=
* 若有变量 xi < 0 ，那么用 x‘ – x”来替代，其中 x’>=0 x”>=0

上述问题就变为了
最大化 
	\\[2x_1 - 3x_2 + 3x_3 \\]
满足约束
\\[ x_1 + x_2 - x_3 ≤ 7 \\]
\\[ -x_1 - x_2 + x_3 ≤ -7\\]
\\[ x_1 - 2x_2 + 2x_3 ≤ 4\\]
\\[x_1, x_2, x_3 >= 0\\]


## 松弛型
就是通过引入变量把原来的 ≤ ，变为=的松弛形式

最大化 
	\\[c^Tx \\]
满足约束
\\[ Ax = b \\]
\\[ x ≥ 0\\]

上述问题就变为了
最大化 
	\\[2x_1 - 3x_2 + 3x_3 \\]
满足约束
\\[ x_4 = 7 - x_1 + x_2 - x_3 \\]
\\[ x_5 = -7 +x_1 + x_2 - x_3\\]
\\[ x_6 = 4 - x_1 + 2x_2 - 2x_3 \\]
\\[x_1, x_2, x_3, x_4, x_5, x_6 >= 0\\]

等式的左边称为基本变量，而右边称为非基本变量。


## 求解方法-单纯形算法

[pulp](https://github.com/coin-or/pulp)等工具可以求解。

下面介绍求解算法，它是求解线性规划的经典方法，虽然它的执行时间在最坏的情况下是非多项式的（指数时间复杂度），但是，在绝大部分情况下或者说实际运行过程中却是多项式时间。

它主要就三个步骤：
* 找到一个初始的基本可行解
* 不断的进行旋转（pivot）操作
* 重复上一步直到结果不能改进为止


举个例子

最大化 
	\\[3x_1 + x_2 + 2x_3 \\]
满足约束
\\[ x_1 + x_2 + x_3 ≤ 30 \\]
\\[ 2x_1 + 2x_2 + 5x_3 ≤ 24\\]
\\[ 4x_1 + x_2 + 2x_3 ≤ 36\\]
\\[x_1, x_2, x_3 >= 0\\]

转化为松弛形式
\\[z = 3x_1 + x_2 + 2x_3 \\]
\\[ x_4 = 30 - x_1 - x_2 - x_3 \\]
\\[ x_5 = 24 - 2x_1 - 2x_2 - 5x_3\\]
\\[ x_6 = 36 - 4x_1 - x_2 - 2x_3 \\]


把所有非基本变量都设置为0，那么就可以得到一个基本可行解(0, 0, 0, 30, 24, 36), z=0.

每次选择一个在目标函数中的系数为负的非基本变量\\( x_e \\), 然后尽可能的增加\\( x_e \\)而不违反约束，并将\\( x_e \\)用基本变量\\( x_l \\)表示, 然后把\\( x_e \\)变为基本变量，\\( x_l \\)变为非基本变量。


在这里我们考虑增加\\( x_1 \\)的值，并与\\( x_6 \\)互换（因为第三个约束是最紧约束）。可得：
\\[z = 27 + \frac{x_2}{4} + \frac{x_3}{2} - \frac{3x_4}{4} \\]
\\[ x_1 = 9 - \frac{x_2}{4} - \frac{x_3}{2} - \frac{x_6}{4} \\]
\\[ x_4 = 21 - \frac{x_2}{4} - \frac{x_3}{2}x_2 - \frac{x_6}{4} \\]
\\[ x_5 = 6 - \frac{3x_2}{2} - 4x_3 + \frac{x_6}{2} \\]

这样其实就是一个转动(pivot)的过程，一次转动选取一个非基本变量（也叫替入变量）\\( x_e \\)和一个基本变量（也叫替出变量）\\( x_l \\) ，然后替换二者的角色。执行一次转动的过程与之前所描述的线性规划是等价的。

重复以上过程，直到目标函数中的变量系数全部为负数，那么就不能再转动了，求得最大值。


## 参考资料

《算法导论》第三版 第29章 线性规划
[线性规划课件Lec8.pdf](http://bioinfo.ict.ac.cn/~dbu/AlgorithmCourses/Lectures/Lec8.pdf)
[blog](https://www.hrwhisper.me/introduction-to-simplex-algorithm/)